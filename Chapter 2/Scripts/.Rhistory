panel.grid.minor.y = element_line(colour = 'white',
linewidth = 0.25),
panel.grid.major.x = element_line(colour = 'white',
linewidth = 0.75),
panel.grid.minor.x = element_line(colour = 'white',
linewidth = 0.25),
strip.text = element_text(face = 'italic'),
axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
F_hmap_its2_top10_p
F_hmap_its2_top10_p <-
F_bar_its2_top10_meta_df |>
ungroup() |>
mutate(Colony = reorder_within(Colony,
desc(`Combined survival and MIG`),
Species)) |>
ggplot(aes(fill = `ITS2 sequence`,
x = Colony,
y = `Read count`)) +
geom_tile(fill = `Read count`) +
facet_grid(cols = vars(Species),
space = 'free',
scale = 'free') +
scale_y_continuous(expand = c(0,0)) +
scale_x_reordered() +
scale_fill_manual(values = F_bar_its2_color_c) +
theme(panel.grid = element_blank(),
strip.background = element_blank(),
axis.line = element_line(),
panel.background = element_rect(fill = '#F5F5F5'),
panel.grid.major.y = element_line(colour = 'white'
,linewidth = 0.75),
panel.grid.minor.y = element_line(colour = 'white',
linewidth = 0.25),
panel.grid.major.x = element_line(colour = 'white',
linewidth = 0.75),
panel.grid.minor.x = element_line(colour = 'white',
linewidth = 0.25),
strip.text = element_text(face = 'italic'),
axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
F_hmap_its2_top10_p <-
F_bar_its2_top10_meta_df |>
ungroup() |>
mutate(Colony = reorder_within(Colony,
desc(`Combined survival and MIG`),
Species)) |>
ggplot(aes(fill = `ITS2 sequence`,
x = Colony,
y = `Read count`)) +
geom_tile(aes(fill = `Read count`)) +
facet_grid(cols = vars(Species),
space = 'free',
scale = 'free') +
scale_y_continuous(expand = c(0,0)) +
scale_x_reordered() +
scale_fill_manual(values = F_bar_its2_color_c) +
theme(panel.grid = element_blank(),
strip.background = element_blank(),
axis.line = element_line(),
panel.background = element_rect(fill = '#F5F5F5'),
panel.grid.major.y = element_line(colour = 'white'
,linewidth = 0.75),
panel.grid.minor.y = element_line(colour = 'white',
linewidth = 0.25),
panel.grid.major.x = element_line(colour = 'white',
linewidth = 0.75),
panel.grid.minor.x = element_line(colour = 'white',
linewidth = 0.25),
strip.text = element_text(face = 'italic'),
axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
F_hmap_its2_top10_p
F_hmap_its2_top10_p <-
F_bar_its2_top10_meta_df |>
ungroup() |>
mutate(Colony = reorder_within(Colony,
desc(`Combined survival and MIG`),
Species)) |>
ggplot(aes(fill = `ITS2 sequence`,
x = Colony,
y = `Read count`)) +
geom_tile(aes(fill = `Read count`)) +
facet_grid(cols = vars(Species),
space = 'free',
scale = 'free') +
scale_y_continuous(expand = c(0,0)) +
scale_x_reordered() +
theme(panel.grid = element_blank(),
strip.background = element_blank(),
axis.line = element_line(),
panel.background = element_rect(fill = '#F5F5F5'),
panel.grid.major.y = element_line(colour = 'white'
,linewidth = 0.75),
panel.grid.minor.y = element_line(colour = 'white',
linewidth = 0.25),
panel.grid.major.x = element_line(colour = 'white',
linewidth = 0.75),
panel.grid.minor.x = element_line(colour = 'white',
linewidth = 0.25),
strip.text = element_text(face = 'italic'),
axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
F_hmap_its2_top10_p
F_hmap_its2_top10_p <-
F_bar_its2_top10_meta_df |>
ungroup() |>
mutate(Colony = reorder_within(Colony,
desc(`Combined survival and MIG`),
Species)) |>
ggplot(aes(x = Colony,
y = `ITS2 sequence`)) +
geom_tile(aes(fill = `Read count`)) +
facet_grid(cols = vars(Species),
space = 'free',
scale = 'free') +
scale_y_continuous(expand = c(0,0)) +
scale_x_reordered() +
theme(panel.grid = element_blank(),
strip.background = element_blank(),
axis.line = element_line(),
panel.background = element_rect(fill = '#F5F5F5'),
panel.grid.major.y = element_line(colour = 'white'
,linewidth = 0.75),
panel.grid.minor.y = element_line(colour = 'white',
linewidth = 0.25),
panel.grid.major.x = element_line(colour = 'white',
linewidth = 0.75),
panel.grid.minor.x = element_line(colour = 'white',
linewidth = 0.25),
strip.text = element_text(face = 'italic'),
axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
F_hmap_its2_top10_p
F_hmap_its2_top10_p <-
F_bar_its2_top10_meta_df |>
ungroup() |>
mutate(Colony = reorder_within(Colony,
desc(`Combined survival and MIG`),
Species)) |>
ggplot(aes(x = Colony,
y = `ITS2 sequence`)) +
geom_tile(aes(fill = `Read count`)) +
facet_grid(cols = vars(Species),
space = 'free',
scale = 'free') +
scale_x_reordered() +
theme(panel.grid = element_blank(),
strip.background = element_blank(),
axis.line = element_line(),
panel.background = element_rect(fill = '#F5F5F5'),
panel.grid.major.y = element_line(colour = 'white'
,linewidth = 0.75),
panel.grid.minor.y = element_line(colour = 'white',
linewidth = 0.25),
panel.grid.major.x = element_line(colour = 'white',
linewidth = 0.75),
panel.grid.minor.x = element_line(colour = 'white',
linewidth = 0.25),
strip.text = element_text(face = 'italic'),
axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
F_hmap_its2_top10_p
F_hmap_its2_top10_p <-
F_bar_its2_top10_meta_df |>
ungroup() |>
mutate(Colony = reorder_within(Colony,
desc(`Combined survival and MIG`),
Species)) |>
mutate(`ITS2 sequence` = log(`ITS2 sequence` + 1)) |>
ggplot(aes(x = Colony,
y = `ITS2 sequence`)) +
geom_tile(aes(fill = `Read count`)) +
facet_grid(cols = vars(Species),
space = 'free',
scale = 'free') +
scale_x_reordered() +
theme(panel.grid = element_blank(),
strip.background = element_blank(),
axis.line = element_line(),
panel.background = element_rect(fill = '#F5F5F5'),
panel.grid.major.y = element_line(colour = 'white'
,linewidth = 0.75),
panel.grid.minor.y = element_line(colour = 'white',
linewidth = 0.25),
panel.grid.major.x = element_line(colour = 'white',
linewidth = 0.75),
panel.grid.minor.x = element_line(colour = 'white',
linewidth = 0.25),
strip.text = element_text(face = 'italic'),
axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
F_hmap_its2_top10_p <-
F_bar_its2_top10_meta_df |>
ungroup() |>
mutate(Colony = reorder_within(Colony,
desc(`Combined survival and MIG`),
Species)) |>
mutate(`Read count`` = log(`Read count` + 1)) |>
F_hmap_its2_top10_p <-
F_bar_its2_top10_meta_df |>
ungroup() |>
mutate(Colony = reorder_within(Colony,
desc(`Combined survival and MIG`),
Species)) |>
mutate(`Read count` = log(`Read count` + 1)) |>
ggplot(aes(x = Colony,
y = `ITS2 sequence`)) +
geom_tile(aes(fill = `Read count`)) +
facet_grid(cols = vars(Species),
space = 'free',
scale = 'free') +
scale_x_reordered() +
theme(panel.grid = element_blank(),
strip.background = element_blank(),
axis.line = element_line(),
panel.background = element_rect(fill = '#F5F5F5'),
panel.grid.major.y = element_line(colour = 'white'
,linewidth = 0.75),
panel.grid.minor.y = element_line(colour = 'white',
linewidth = 0.25),
panel.grid.major.x = element_line(colour = 'white',
linewidth = 0.75),
panel.grid.minor.x = element_line(colour = 'white',
linewidth = 0.25),
strip.text = element_text(face = 'italic'),
axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
F_hmap_its2_top10_p
F_hmap_its2_top10_p <-
F_bar_its2_top10_meta_df |>
ungroup() |>
mutate(Colony = reorder_within(Colony,
desc(`Combined survival and MIG`),
Species)) |>
mutate(`Read count` = log(`Read count` + 1)) |>
ggplot(aes(x = Colony,
y = `ITS2 sequence`)) +
geom_tile(aes(fill = `Read count`),
color = 'white') +
facet_grid(cols = vars(Species),
space = 'free',
scale = 'free') +
scale_x_reordered() +
theme(panel.grid = element_blank(),
strip.background = element_blank(),
axis.line = element_line(),
panel.background = element_rect(fill = '#F5F5F5'),
panel.grid.major.y = element_line(colour = 'white'
,linewidth = 0.75),
panel.grid.minor.y = element_line(colour = 'white',
linewidth = 0.25),
panel.grid.major.x = element_line(colour = 'white',
linewidth = 0.75),
panel.grid.minor.x = element_line(colour = 'white',
linewidth = 0.25),
strip.text = element_text(face = 'italic'),
axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
F_hmap_its2_top10_p
F_hmap_its2_top10_p <-
F_bar_its2_top10_meta_df |>
ungroup() |>
mutate(Colony = reorder_within(Colony,
desc(`Combined survival and MIG`),
Species)) |>
mutate(`Read count` = log(`Read count` + 1)) |>
ggplot(aes(x = Colony,
y = `ITS2 sequence`)) +
geom_tile(aes(fill = `Read count`),
color = 'white',
linewidth = 0.1) +
facet_grid(cols = vars(Species),
space = 'free',
scale = 'free') +
scale_x_reordered() +
theme(panel.grid = element_blank(),
strip.background = element_blank(),
axis.line = element_line(),
panel.background = element_rect(fill = '#F5F5F5'),
panel.grid.major.y = element_line(colour = 'white'
,linewidth = 0.75),
panel.grid.minor.y = element_line(colour = 'white',
linewidth = 0.25),
panel.grid.major.x = element_line(colour = 'white',
linewidth = 0.75),
panel.grid.minor.x = element_line(colour = 'white',
linewidth = 0.25),
strip.text = element_text(face = 'italic'),
axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
F_hmap_its2_top10_p
F_hmap_its2_top10_p <-
F_bar_its2_top10_meta_df |>
ungroup() |>
mutate(Colony = reorder_within(Colony,
desc(`Combined survival and MIG`),
Species)) |>
mutate(`Read count` = log(`Read count` + 1)) |>
ggplot(aes(x = Colony,
y = `ITS2 sequence`)) +
geom_tile(aes(fill = `Read count`),
color = 'white',
linewidth = 0.1) +
facet_grid(cols = vars(Species),
space = 'free',
scale = 'free') +
scale_x_reordered() +
scale_fill_distiller() +
theme(panel.grid = element_blank(),
strip.background = element_blank(),
axis.line = element_line(),
panel.background = element_rect(fill = '#F5F5F5'),
panel.grid.major.y = element_line(colour = 'white'
,linewidth = 0.75),
panel.grid.minor.y = element_line(colour = 'white',
linewidth = 0.25),
panel.grid.major.x = element_line(colour = 'white',
linewidth = 0.75),
panel.grid.minor.x = element_line(colour = 'white',
linewidth = 0.25),
strip.text = element_text(face = 'italic'),
axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
F_hmap_its2_top10_p
F_hmap_its2_top10_p <-
F_bar_its2_top10_meta_df |>
ungroup() |>
mutate(Colony = reorder_within(Colony,
desc(`Combined survival and MIG`),
Species)) |>
mutate(`Read count` = log(`Read count` + 1)) |>
ggplot(aes(x = Colony,
y = `ITS2 sequence`)) +
geom_tile(aes(fill = `Read count`),
color = 'white',
linewidth = 0.1) +
facet_grid(cols = vars(Species),
space = 'free',
scale = 'free') +
scale_x_reordered() +
scale_fill_distiller(-1) +
theme(panel.grid = element_blank(),
strip.background = element_blank(),
axis.line = element_line(),
panel.background = element_rect(fill = '#F5F5F5'),
panel.grid.major.y = element_line(colour = 'white'
,linewidth = 0.75),
panel.grid.minor.y = element_line(colour = 'white',
linewidth = 0.25),
panel.grid.major.x = element_line(colour = 'white',
linewidth = 0.75),
panel.grid.minor.x = element_line(colour = 'white',
linewidth = 0.25),
strip.text = element_text(face = 'italic'),
axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
F_hmap_its2_top10_p
F_hmap_its2_top10_p <-
F_bar_its2_top10_meta_df |>
ungroup() |>
mutate(Colony = reorder_within(Colony,
desc(`Combined survival and MIG`),
Species)) |>
mutate(`Read count` = log(`Read count` + 1)) |>
ggplot(aes(x = Colony,
y = `ITS2 sequence`)) +
geom_tile(aes(fill = `Read count`),
color = 'white',
linewidth = 0.1) +
facet_grid(cols = vars(Species),
space = 'free',
scale = 'free') +
scale_x_reordered() +
scale_fill_distiller(direction = -1) +
theme(panel.grid = element_blank(),
strip.background = element_blank(),
axis.line = element_line(),
panel.background = element_rect(fill = '#F5F5F5'),
panel.grid.major.y = element_line(colour = 'white'
,linewidth = 0.75),
panel.grid.minor.y = element_line(colour = 'white',
linewidth = 0.25),
panel.grid.major.x = element_line(colour = 'white',
linewidth = 0.75),
panel.grid.minor.x = element_line(colour = 'white',
linewidth = 0.25),
strip.text = element_text(face = 'italic'),
axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
F_hmap_its2_top10_p
F_hmap_its2_top10_p <-
F_bar_its2_top10_meta_df |>
ungroup() |>
mutate(Colony = reorder_within(Colony,
desc(`Combined survival and MIG`),
Species)) |>
mutate(`Read count` = log(`Read count` + 1)) |>
ggplot(aes(x = Colony,
y = `ITS2 sequence`)) +
geom_tile(aes(fill = `Read count`),
color = 'white',
linewidth = 0.1) +
facet_grid(cols = vars(Species),
space = 'free',
scale = 'free') +
scale_x_reordered() +
scale_fill_distiller(direction = -1) +
theme(panel.grid = element_blank(),
strip.background = element_blank(),
axis.line = element_line(),
panel.background = element_rect(fill = '#F5F5F5'),
panel.grid.major.y = element_line(colour = 'white'
,linewidth = 0.75),
panel.grid.minor.y = element_line(colour = 'white',
linewidth = 0.25),
panel.grid.major.x = element_line(colour = 'white',
linewidth = 0.75),
panel.grid.minor.x = element_line(colour = 'white',
linewidth = 0.25),
strip.text = element_text(face = 'italic'),
axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
F_hmap_its2_top10_p
F_hmap_its2_top10_p <-
F_bar_its2_top10_meta_df |>
ungroup() |>
mutate(Colony = reorder_within(Colony,
desc(`Combined survival and MIG`),
Species)) |>
mutate(`Read count` = log(`Read count` + 1)) |>
ggplot(aes(x = Colony,
y = `ITS2 sequence`)) +
geom_tile(aes(fill = `Read count`),
color = 'white',
linewidth = 0.1) +
facet_grid(cols = vars(Species),
space = 'free',
scale = 'free') +
scale_x_reordered() +
scale_fill_distiller(direction = 1) +
theme(panel.grid = element_blank(),
strip.background = element_blank(),
axis.line = element_line(),
panel.background = element_rect(fill = '#F5F5F5'),
panel.grid.major.y = element_line(colour = 'white'
,linewidth = 0.75),
panel.grid.minor.y = element_line(colour = 'white',
linewidth = 0.25),
panel.grid.major.x = element_line(colour = 'white',
linewidth = 0.75),
panel.grid.minor.x = element_line(colour = 'white',
linewidth = 0.25),
strip.text = element_text(face = 'italic'),
axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
F_hmap_its2_top10_p
F_hmap_its2_top10_p <-
F_bar_its2_top10_meta_df |>
ungroup() |>
mutate(Colony = reorder_within(Colony,
desc(`Combined survival and MIG`),
Species)) |>
mutate(`Read count` = log(`Read count` + 1)) |>
ggplot(aes(x = Colony,
y = `ITS2 sequence`)) +
geom_tile(aes(fill = `Read count`),
color = 'white',
linewidth = 0.1) +
facet_grid(cols = vars(Species),
space = 'free',
scale = 'free') +
scale_x_reordered() +
scale_fill_distiller(direction = 1,
palette = 'Greens') +
theme(panel.grid = element_blank(),
strip.background = element_blank(),
axis.line = element_line(),
panel.background = element_rect(fill = '#F5F5F5'),
panel.grid.major.y = element_line(colour = 'white'
,linewidth = 0.75),
panel.grid.minor.y = element_line(colour = 'white',
linewidth = 0.25),
panel.grid.major.x = element_line(colour = 'white',
linewidth = 0.75),
panel.grid.minor.x = element_line(colour = 'white',
linewidth = 0.25),
strip.text = element_text(face = 'italic'),
axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
F_hmap_its2_top10_p
F_bar_its2_top10_meta_df
F_bar_its2_top10_meta_df |> group_by(`ITS2 sequence`) |> summarise(sum(`Read count`))
F_bar_its2_count_p <-
F_bar_its2_top10_meta_df |>
group_by(`ITS2 sequence`) |>
summarise(sum(`Read count`)) |>
ggplot(aes(y = `ITS2 sequence`,
x = `Read count`)) +
geom_bar()
F_bar_its2_count_p
F_bar_its2_count_p <-
F_bar_its2_top10_meta_df |>
group_by(`ITS2 sequence`) |>
summarise(`Read count` = sum(`Read count`)) |>
ggplot(aes(y = `ITS2 sequence`,
x = `Read count`)) +
geom_bar()
F_bar_its2_count_p
F_bar_its2_top10_meta_df |>
group_by(`ITS2 sequence`) |>
summarise(`Read count` = sum(`Read count`))
F_bar_its2_count_p <-
F_bar_its2_top10_meta_df |>
group_by(`ITS2 sequence`) |>
summarise(`Read count` = sum(`Read count`)) |>
ggplot(aes(x = `ITS2 sequence`,
y = `Read count`)) +
geom_bar()
F_bar_its2_count_p
F_bar_its2_count_p <-
F_bar_its2_top10_meta_df |>
group_by(`ITS2 sequence`) |>
summarise(`Read count` = sum(`Read count`)) |>
ggplot(aes(y = `ITS2 sequence`,
x = `Read count`)) +
geom_col()
F_bar_its2_count_p
